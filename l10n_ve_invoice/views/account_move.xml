<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_account_move_form_l10n_ve_invoice" model="ir.ui.view">
        <field name="name">view.account.move.form.binaural.invoice</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
	    <field name="invoice_has_outstanding" position="after">
		<field name="is_contingency" invisible="1"/>
	    </field>
            <xpath expr="//field[@name='invoice_user_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//div[hasclass('oe_title')]/h1" position="attributes">
                <attribute name="attrs">{'invisible': [('move_type', 'not in', ('in_invoice', 'in_refund', 'in_receipt')), ('posted_before', '=', False), ('is_contingency', '=', False)]}</attribute>
            </xpath>

            <field name="name" position="attributes">
		<attribute name="attrs">
		    {
			'readonly': ['&amp;', '|', ('move_type', 'in', ('out_invoice', 'out_refund')), ('is_contingency', '=', False), ('state', '=', 'posted')],
			'required': ['|', ('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')), ('is_contingency', '=', True)]
		    }
		</attribute>
                <attribute name="placeholder">JRNL/2016/00001</attribute>
            </field>

            <xpath expr="//div[hasclass('oe_title')]/h1" position="after">
                <div class="inline-block"></div>
                <label for="correlative"
                    style="font-weight: bold;"
                    attrs="{'invisible': [('move_type', 'not in', ['out_invoice', 'out_refund', 'in_invoice', 'in_refund'])],}"/>
                <!-- attrs of "correlative" is overwritten in l10n_ve_commissions/account_move_views.xml -->
                <field name="correlative"
                    attrs="{
                        'invisible': [('move_type', 'not in', ['out_invoice', 'out_refund', 'in_invoice', 'in_refund'])],
                        'readonly':  ['|', '&amp;', ('move_type', 'in', ['out_invoice', 'out_refund']), ('is_contingency', '=', False), ('state', '=', 'posted')],
                        'required':  [('move_type', 'in', ['in_invoice', 'in_refund'])]
                    }"/>
            </xpath>

            <xpath expr="//field[@name='invoice_date']" position="after">
                <field name="invoice_reception_date"
                    options="{'datepicker': {'warn_future': true}}"
                    attrs="{
                        'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'out_receipt','in_invoice', 'in_refund', 'in_receipt'))],
                        'readonly':  [('state', '=', 'draft')]
                    }"/>
            </xpath>
        </field>
    </record>

    <record id="view_account_move_od_journal_sequence" model="ir.ui.view">
        <field name="name">view.account.move.od.journal.sequence</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="od_journal_sequence.view_move_form"/>
        <field name="arch" type="xml">
	    <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="readonly">False</attribute>
            </xpath>
	</field>
    </record>

        <!-- ACTION OUT_INVOICE -->
        <record id="account.action_move_out_invoice_type" model="ir.actions.act_window">
            <field name="name">Invoices</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="account.view_out_invoice_tree" />
            <field name="search_view_id" ref="account.view_account_invoice_filter" />
            <field name="domain">[('move_type', '=', 'out_invoice')]</field>
            <field name="context">{'default_move_type': 'out_invoice', 'default_filter_partner': 'customer'}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                Create a customer invoice
              </p>
                <p>
                Create invoices, register payments and keep track of the discussions with your customers.
              </p>
            </field>
        </record>

        <!-- ACTION OUT_REFUND -->
        <record id="account.action_move_out_refund_type" model="ir.actions.act_window">
            <field name="name">Credit Notes</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="account.view_out_credit_note_tree" />
            <field name="search_view_id" ref="account.view_account_invoice_filter" />
            <field name="domain">[('move_type', '=', 'out_refund')]</field>
            <field name="context">{'default_move_type': 'out_refund', 'default_filter_partner': 'customer'}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                Create a credit note
              </p>
                <p>
                Note that the easiest way to create a credit note is to do it directly
                from the customer invoice.
              </p>
            </field>
        </record>

        <!-- ACTION IN_INVOICE -->
        <record id="account.action_move_in_invoice_type" model="ir.actions.act_window">
            <field name="name">Bills</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="account.view_in_invoice_tree" />
            <field name="search_view_id" ref="account.view_account_invoice_filter" />
            <field name="domain">[('move_type', '=', 'in_invoice')]</field>
            <field name="context">{'default_move_type': 'in_invoice', 'default_filter_partner': 'supplier'}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                Create a vendor bill
              </p>
                <p>
                Create invoices, register payments and keep track of the discussions with your vendors.
              </p>
            </field>
        </record>

        <!-- ACTION IN_REFUND -->
        <record id="account.action_move_in_refund_type" model="ir.actions.act_window">
            <field name="name">Refunds</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="account.view_in_invoice_tree" />
            <field name="search_view_id" ref="account.view_account_invoice_filter" />
            <field name="domain">[('move_type', '=', 'in_refund')]</field>
            <field name="context">{'default_move_type': 'in_refund', 'default_filter_partner': 'supplier'}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                Create a vendor credit note
              </p>
                <p>
                Note that the easiest way to create a vendor credit note it to do it directly from the vendor bill.
              </p>
            </field>
        </record>


        <!-- ORDER FIELD -->
        <record id="account_move_form_l10n_ve_account_move" model="ir.ui.view">
            <field name="name">account.move.form.binaural.account.move</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[@id='header_right_group']/div[3]" position="after">
                    <field name="invoice_origin" string="Nro de Pedido"/>
                    <field name="invoice_user_id"/>
                </xpath>
            </field>
        </record>

        <record id="l10n_ve_invoice_view_invoice_tree" model="ir.ui.view">
            <field name="name">account.move.tree.binaural.invoice</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_invoice_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="after">
                    <field name="correlative" optional="hide"/>
                </xpath>
            </field>
        </record>

</odoo>
