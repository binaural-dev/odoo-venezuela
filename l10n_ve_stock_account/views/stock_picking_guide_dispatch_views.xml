<odoo>
    <record id="stock_picking_guide_dispatch_views" model="ir.ui.view">
        <field name="name">stock.picking.guide.dispatch.account.views</field>
        <field name="model">stock.picking</field>
        <field name="arch" type="xml">
            <tree string="Picking list" multi_edit="1" sample="1" create="0">
                <header>
                    <button name="create_invoice_lots" type="object" string="Create Invoice by Lots"/>
                </header>
                <field name="name" decoration-bf="1"/>
                <field name="guide_number" string="Guide Number"/>
                <field name="date_done" string="Guide Date"/>
                <field name="show_create_invoice" invisible="1"/>
                <field name="show_create_bill" invisible="1"/>
                <field name="show_create_customer_credit" invisible="1"/>
                <field name="show_create_vendor_credit" invisible="1"/>
                <field 
                    name="state_guide_dispatch" 
                    string="State Guide Dispatch" 
                    widget="badge" 
                    decoration-muted="state_guide_dispatch == 'to_invoice'"
                    decoration-success="state_guide_dispatch == 'invoiced'"
                />
                <button 
                    name="create_invoice" 
                    class="btn btn-link text-info" 
                    icon="fa-file-text" 
                    string="Create Invoice" 
                    type="object"
                    attrs="{'invisible': [('show_create_invoice', '=', False)]}"
                />
                <button 
                    name="create_bill" 
                    class="btn btn-link text-info" 
                    icon="fa-file-text" 
                    string="Create Bill" 
                    type="object"
                    attrs="{'invisible': [('show_create_bill', '=', False)]}"
                />
                <button 
                    name="create_customer_credit" 
                    class="btn btn-link text-info" 
                    icon="fa-file-text" 
                    string="Create Credit Note" 
                    type="object"
                    attrs="{'invisible': [('show_create_customer_credit', '=', False)]}"
                />
                <button 
                    name="create_vendor_credit" 
                    class="btn btn-link text-info" 
                    icon="fa-file-text" 
                    string="Create Vendor Credit" 
                    type="object"
                    attrs="{'invisible': [('show_create_vendor_credit', '=', False)]}"
                />
            </tree>
        </field>
    </record>

    <record id="stock_picking_guide_dispatch_view_search" model="ir.ui.view">
        <field name="name">stock.picking.guide.dispatch.view.search</field>
        <field name="model">stock.picking</field>
        <field name="arch" type="xml">
            
            <search string="Search">
                <field name="name" />
                <field name="guide_number" />
            
                <filter name="state_guide_dispatch" string="State guide dispatch" context="{'group_by': 'state_guide_dispatch'}"/>
                <filter name="date_done_group" string="Guide Date" context="{'group_by': 'date_done'}"/>

                <filter name="state_guide_dispatch_to_invoice" string="To Invoice" domain="[('state_guide_dispatch', '=', 'to_invoice'),('type_delivery_step', '=', 'out')]"/>
                <filter name="state_guide_dispatch_invoiced" string="Invoiced" domain="[('state_guide_dispatch', '=', 'invoiced')]"/>
                <filter name="date_done_filter" string="Guide Date" date="date_done"/>
            </search>
        </field>
    </record>

    <record id="action_picking_guide_dispatch" model="ir.actions.act_window">
        <field name="name">Report Guide Dispatch</field>
        <field name="res_model">stock.picking</field>
        <field name="type">ir.actions.act_window</field>
        <field name="view_mode">tree</field>
        <field 
            name="view_ids" 
            eval="[
                (5, 0, 0), 
                (0, 0, {'view_mode': 'tree', 'view_id': ref('l10n_ve_stock_account.stock_picking_guide_dispatch_views')}),
            ]"
        />
        <field name="context">{"search_default_state_guide_dispatch_to_invoice":1}</field>
    </record>
</odoo>
