<odoo>
    <record id="l10n_ve_stock_account_account_move_form_view" model="ir.ui.view">
        <field name="name">l10n.ve.stock.account.account.move.form.view</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">


            <xpath expr="//form//header" position="inside">
                <button
                    name="print_invoice_free_form" string="Free Form"
                    type="object" class="o_btn_validate"
                    invisible="(move_type not in ('out_invoice', 'out_refund')) or state != 'posted' or correlative == False"
                />
            </xpath>

            <xpath expr="//field[@name='ref']" position="after">
                <field name="guide_number"/>
                <field name="free_form_copy_number" readonly="1" />
                <field name="transfer_ids" widget="many2many_tags" invisible="1" />
            </xpath>

            <!-- TODO: La línea entera debería estar bloqueada al `from_picking_line` ser True -->
            <!-- Esta manera es un poco rebuscada y no termina de ser del todo consistente -->
            <!-- ya que no garantiza que en otras vistas u otros campos no sean editables -->
            <xpath expr="//page[@id='invoice_tab']/field[@name='invoice_line_ids']/list"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[1]" position="before">
                <field name="from_picking_line" readonly="1" invisible="1"/>
            </xpath>

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='quantity']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='price_unit']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <!-- <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='foreign_price']" position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath> -->

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='account_id']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='name']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>
            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='product_id']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='discount']"
                position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath>

            <xpath
                expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='not_deductible_tax']"
                position="attributes">
                <attribute name="readonly">{'readonly': [('from_picking_line', '=',True)]}</attribute>
            </xpath>

            <!-- <xpath expr="//page[@id='invoice_tab'][1]/field[1]/list[1]/field[@name='tax_ids']" position="attributes">
                <attribute name="readonly">from_picking_line == True</attribute>
            </xpath> -->

        </field>
    </record>
    <record id="view_invoice_tree" model="ir.ui.view">
        <field name="name">account.move.list</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='correlative']" position="after">
                <field
                    name="guide_number"
                    string='Guide Number'
                    optional="hide" />
            </xpath>
        </field>
    </record>

</odoo>
